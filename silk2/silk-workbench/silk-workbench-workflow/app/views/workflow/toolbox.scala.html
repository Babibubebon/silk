@(project: de.fuberlin.wiwiss.silk.workspace.Project)

@import de.fuberlin.wiwiss.silk.workspace.modules.ModuleTask
@import plugins.WorkbenchPlugins
@import plugins.WorkbenchPlugin.TaskActions
@import de.fuberlin.wiwiss.silk.util.Identifier
@import controllers.workflow.routes.Assets

<div id="toolbox" style="height: 67.9px;">
  @for(plugin <- WorkbenchPlugins();
       taskActions <- plugin.tasks;
       task <- taskActions.projectTasks(project)) {
    <div>
      @toolboxOperator(task, taskActions)
    </div>
  }
</div>

@**
 * A single operator in the toolbox.
 *@
@toolboxOperator(task: ModuleTask, taskActions: TaskActions[_]) = {
  <div id="toolbox_@task.name" class="toolboxOperator" title="@task.name">
    @*<img src="@icon">*@
    @task.name
    @if(taskActions.name != "Dataset") {
      @operator(task, taskActions)
    } else {
      @dataset(task.name)
    }
  </div>
}

@operator(task: ModuleTask, taskActions: TaskActions[_]) = {
  <div class="operator" style="display:none;" >
    <div class="operatorHeader">
      @*<img src="@icon">*@
      <div style="width: 160px; white-space:nowrap; overflow:hidden; float: left;" title="">
        @task.name (@taskActions.name)
      </div>
      <img align="right" src="@Assets.at("img/delete.png")" style="cursor:pointer;" onclick="removeElement($(this).parent().parent().attr('id'))"/>
      @for(path <- taskActions.open(project.name, task.name)) {
        <img align="right" src="@Assets.at("img/wrench-screwdriver.png")" style="cursor:pointer;" onclick="window.location = '@config.baseUrl/@path'" />
      }
    </div>
    <div class="operatorContent">
        name:
        <span class="label">id</span>
        <br/>
        @for(((key, value), index) <- taskActions.properties(task).zipWithIndex) {
            @if(index != 0) {<br/>}
            @key: @value
        }
    </div>
  </div>
}

@dataset(name: Identifier) = {
  <div class="dataset" style="display: none">
    <div class="dataset-bottom"></div>
    <div class="dataset-contents">
      @name
      <img src="@Assets.at("img/delete.png")" style="cursor:pointer;" onclick="removeElement($(this).parent().parent().attr('id'))"/>
    </div>
    <div class="dataset-top"></div>
  </div>
}